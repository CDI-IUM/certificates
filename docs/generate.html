<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Generate Certificates</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header>
    <div class="layout-container">
      <h1>Certificate Generator</h1>
      <p class="helper-text">Encrypt certificate payloads, mint QR codes, and export verification links in seconds.</p>
      <div class="print-actions">
        <a class="btn" href="./index.html">⬅ Back to Home</a>
        <a class="btn btn-secondary" href="./verify.html">Open Verifier</a>
      </div>
    </div>
  </header>

  <main>
    <section class="layout-container">
      <div class="card">
        <h2>Single Certificate</h2>
        <form id="certificate-form">
          <div class="form-row">
            <div>
              <label for="certificateId">Certificate ID</label>
              <div class="form-row">
                <input type="text" id="certificateId" name="certificateId" required />
                <button type="button" class="btn btn-tertiary" id="auto-id">Auto Generate</button>
              </div>
              <p class="helper-text">Default prefix comes from <code>config.json</code>.</p>
            </div>
          </div>

          <div class="form-row">
            <div>
              <label for="fullName">Full Name</label>
              <input type="text" id="fullName" name="fullName" placeholder="Jane Smith" required />
            </div>
            <div>
              <label for="courseName">Course Name</label>
              <input type="text" id="courseName" name="courseName" placeholder="Advanced Web Development" required />
            </div>
          </div>

          <div class="form-row">
            <div>
              <label for="completionDate">Completion Date</label>
              <input type="date" id="completionDate" name="completionDate" required />
            </div>
            <div>
              <label for="issuer">Issuer</label>
              <input type="text" id="issuer" name="issuer" required />
            </div>
          </div>

          <div class="form-row">
            <div>
              <label for="notes">Notes (optional)</label>
              <textarea id="notes" name="notes" rows="3" placeholder="Special distinctions, batch name, etc."></textarea>
              <p class="helper-text">Notes are not encrypted in the payload but help you keep track of drafts. They will not appear in the QR code.</p>
            </div>
          </div>

          <div class="form-row">
            <button type="submit" class="btn" id="generate-btn">Generate Certificate</button>
            <button type="button" class="btn btn-secondary" id="copy-url" disabled>Copy URL</button>
            <button type="button" class="btn btn-secondary" id="download-qr" disabled>Download QR</button>
            <button type="button" class="btn btn-tertiary" id="clear-form">Clear Form</button>
          </div>
        </form>

        <div class="grid-two" style="margin-top:2rem;">
          <div>
            <h3>Verification URL</h3>
            <div class="certificate-field">
              <span>URL</span>
              <strong id="verification-url">Create a certificate to generate the link.</strong>
            </div>
            <h3>Payload Preview</h3>
            <pre id="payload-preview">{ }
</pre>
          </div>
          <div>
            <h3>QR Code Preview</h3>
            <div class="qr-preview">
              <div id="qrcode" class="qr-image-wrapper"></div>
              <p class="helper-text">PNG download becomes available after generating.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2>Batch Generation (CSV)</h2>
        <p class="helper-text">Upload a CSV with columns: <code>fullName,courseName,completionDate</code>. Certificate IDs will auto-increment using your configured prefix.</p>
        <div class="form-row">
          <input type="file" id="csv-upload" accept=".csv" />
          <button type="button" class="btn" id="process-csv">Process CSV</button>
          <button type="button" class="btn btn-secondary" id="download-batch" disabled>Download ZIP (QRs)</button>
        </div>
        <div class="progress-indicator" id="batch-progress" style="display:none;">
          <span>Processing…</span>
          <div id="batch-status"></div>
        </div>
        <div id="batch-error" class="alert" style="display:none;"></div>
        <div class="table-wrapper" id="batch-results" style="display:none;">
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>Certificate ID</th>
                <th>Full Name</th>
                <th>Course</th>
                <th>Completion Date</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>© <span id="year"></span> Certificate Verification Suite</p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" integrity="sha512-Ia4H3B+5xEXLMaLLfi5yRvCNrI6VOGGAaHo9dZYkTfGZNVVRFl1FdYyqS/fWznuaCG2l9VmIAXoJ1Bs8tnAZ2Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" integrity="sha512-V9KUz7Dnk3a1JpN96CBvs1+qsSVqSdz+CA0nVddOZXS6jttuPAHyBs+K6TfGsDz3jHK5vVsQt1zAr72XdTXL0A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="./crypto.js"></script>
  <script src="./generate.js"></script>
</body>
</html>
